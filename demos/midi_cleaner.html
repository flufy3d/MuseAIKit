<!-- Copyright 2018 Google Inc. All Rights Reserved.
Licensed under the Apache License, Version 2.0 (the "License");
you may not use this file except in compliance with the License.
You may obtain a copy of the License at
    http://www.apache.org/licenses/LICENSE-2.0
==============================================================================-->
<html>
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width, initial-scale=1">
  <title>MIDI Cleaner</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      max-width: 800px;
      margin: 0 auto;
      padding: 20px;
    }
    .button {
      background: #4285f4;
      color: white;
      border: none;
      padding: 10px 15px;
      border-radius: 4px;
      cursor: pointer;
    }
    input[type="file"] {
      display: none;
    }
    .audio-container {
      margin: 20px 0;
    }
    #results {
      background: #f5f5f5;
      padding: 15px;
      border-radius: 4px;
      white-space: pre-wrap;
      margin-top: 20px;
    }
  </style>
</head>
<body>
  <h1>MIDI Cleaner</h1>
  <p>Optimize piano transcription results by merging fragmented notes and filtering short notes.</p>

  <h2>Process Audio File</h2>
  <section>
    <label class="button">
      Select Audio File
      <input type="file" id="fileInput" accept="audio/*">
    </label>
    <div class="audio-container">
      <audio id="audioPlayer" controls></audio>
    </div>
  </section>

  <!-- 在<body>标签内，找到Processed Results部分，修改为： -->
  <h2>Processed Results</h2>
  <div id="results"></div>
  <p>Processing time: <span id="time"></span></p>
  
  <!-- 添加MIDI播放器部分 -->
  <h3>MIDI Playback</h3>
  <div>
    <section>
      <button id="playOriginalBtn">播放原始序列</button>
      <button id="playCleanedBtn">播放清理后序列</button>
      <button id="stopPlaybackBtn">停止播放</button>
      
      <!-- 修改为两个可视化区域 -->
      <div class="visualizer-container">
        <h4>原始序列可视化</h4>
        <div id="original-visualizer" style="width: 100%; height: 200px;"></div>
      </div>
      <div class="visualizer-container">
        <h4>清理后序列可视化</h4>
        <div id="cleaned-visualizer" style="width: 100%; height: 200px;"></div>
      </div>
      
      <h3>原始音符序列: <span id="original-count">0</span> 个音符</h3>
      <pre id="original-notes" style="max-height: 200px; overflow: auto;"></pre>
      
      <h3>清理后音符序列: <span id="cleaned-count">0</span> 个音符</h3>
      <pre id="cleaned-notes" style="max-height: 200px; overflow: auto;"></pre>
    </section>
  </div>
  <div class="audio-container">
    <div id="visualizer" style="width: 100%; height: 200px;"></div>
  </div>
  
  <script src="midi_cleaner_bundle.js"></script>
</body>
</html>